pipeline {
    agent any

    stages {
        stage('Extract Credentials') {
            steps {
                script {
                    withCredentials([sshUserPrivateKey(credentialsId: 'aa_11', keyFileVariable: 'SSH_KEY', usernameVariable: 'SSH_USER')]) {
                        // You can now use the SSH_USER and SSH_KEY variables to reference the username and private key file
                        echo "SSH Username: ${SSH_USER}"
                        echo "SSH Private Key file path: ${SSH_KEY}"
                        
                        // For example, you might want to copy the key file to a specific location
                        sh 'cp $SSH_KEY /path/to/destination'
                        
                        // Or use it directly in an SSH command
                        sh '''
                            ssh -i $SSH_KEY $SSH_USER@hostname << EOF
                            echo "Connected to remote host"
                            EOF
                        '''
                    }
                }
            }
        }
    }
}
